
# -*- coding: utf-8 -*-
# Author        : Jesse Wei
# LastUpdate    : 2020/10/04
# Impact        : Jobs generated by SQLG
# Message       : Humanity towards others, we live by sharing. Fear can hold you prisoner, only hope can set you free.

# from __future__ import print_function
import logging
import airflow
from datetime import datetime, timedelta
from airflow.operators.sensors import ExternalTaskSensor
from airflow.operators.python_operator import PythonOperator
from airflow.operators.oracle_operator import OracleOperator

from airflow import models
from airflow.models import Variable

from acme.operators.dwh_operators import PostgresOperatorWithTemplatedParams


# DB_NAME = 'DWH'

my_taskid = "WO_WS1"
WO_WS1 = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SPN_TABL_WS1"
SPN_TABL_WS1 = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "STAGE_WS1"
STAGE_WS1 = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "WO_ROUTING_WS1"
WO_ROUTING_WS1 = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "YIELDRATEWO_YR_WS1"
YIELDRATEWO_YR_WS1 = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SMT_LINE_WS1"
SMT_LINE_WS1 = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "ABNORMAL_DETAIL_WS1"
ABNORMAL_DETAIL_WS1 = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "PD_ABNORMALCODE_WS1"
PD_ABNORMALCODE_WS1 = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "MO_STATUS_WS1"
MO_STATUS_WS1 = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "MO_OUTPUT_QTY_WS1"
MO_OUTPUT_QTY_WS1 = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "CHANGE_LINE_WS1"
CHANGE_LINE_WS1 = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "LINE_LIST_WS1"
LINE_LIST_WS1 = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "TRIAL_FORMULA_WS1"
TRIAL_FORMULA_WS1 = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "TRIAL_FORMULA_SMT_WS1"
TRIAL_FORMULA_SMT_WS1 = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "LINE_WS1"
LINE_WS1 = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "ASS_RESULT_WS1"
ASS_RESULT_WS1 = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "ASS_STAGE_WS1"
ASS_STAGE_WS1 = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "BU_WS1"
BU_WS1 = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "BI_DIMBUDESC"
BI_DIMBUDESC = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "XXWIP_STOREIN_USAGE_TEMP"
XXWIP_STOREIN_USAGE_TEMP = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "MV_XX_MTL_ITEM_CATEGORY"
MV_XX_MTL_ITEM_CATEGORY = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "WIP_ENTITIES"
WIP_ENTITIES = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "WIP_LINES"
WIP_LINES = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "WIP_DISCRETE_JOBS"
WIP_DISCRETE_JOBS = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_EMPLOYEE_H"
SDM_EMPLOYEE_H = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_MANUFACTURING_ORDER"
SDM_MANUFACTURING_ORDER = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_FPYR_IN_SINGLE_STATION"
SDM_FPYR_IN_SINGLE_STATION = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_FIRST_PASS_YIELD_RATE"
SDM_FIRST_PASS_YIELD_RATE = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_STAGE"
SDM_STAGE = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_PROCESS"
SDM_PROCESS = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_LINE"
SDM_LINE = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_SHIFT"
SDM_SHIFT = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_AUTO_EQUIPMENT_STDH"
SDM_AUTO_EQUIPMENT_STDH = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_ACTIVATION"
SDM_ACTIVATION = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_SFCS_OUTPUT_QTY"
SDM_SFCS_OUTPUT_QTY = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_STANDARD_HOUR"
SDM_STANDARD_HOUR = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_DIPATP_SFCS_OUTPUT_HOUR"
SDM_DIPATP_SFCS_OUTPUT_HOUR = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_DIPATP_TTL_INPUT_HOURS"
SDM_DIPATP_TTL_INPUT_HOURS = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_PRODUCTIVITY_DIPATP"
SDM_PRODUCTIVITY_DIPATP = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_SMT_SFCS_OUTPUT_HOUR"
SDM_SMT_SFCS_OUTPUT_HOUR = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_SMT_WORK_HOUR"
SDM_SMT_WORK_HOUR = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_PRODUCTIVITY_SMT"
SDM_PRODUCTIVITY_SMT = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_ORACLE_OUTPUT_HOUR"
SDM_ORACLE_OUTPUT_HOUR = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_COST_OF_POOR_QLY"
SDM_COST_OF_POOR_QLY = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_COST_OF_POOR_QUALITY_PC"
SDM_COST_OF_POOR_QUALITY_PC = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_SCRAP_AMT"
SDM_SCRAP_AMT = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_SCRAP_AMT"
SDM_SCRAP_AMT = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_SCRAP_AMT_RATIO"
SDM_SCRAP_AMT_RATIO = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_FCST_DEMAND_QTY_LMEV"
SDM_FCST_DEMAND_QTY_LMEV = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "FCST_DEMAND_AMT_LMEV"
FCST_DEMAND_AMT_LMEV = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_EST_DLV_IN_CURRENT_MONTH"
SDM_EST_DLV_IN_CURRENT_MONTH = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_EST_DLV_AMT_HIT_RATE"
SDM_EST_DLV_AMT_HIT_RATE = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_ACM_SHIPMENT_AMT_HIT_RATE"
SDM_ACM_SHIPMENT_AMT_HIT_RATE = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "SDM_PRD_OTPT_HIT_R_QTY_LMEV"
SDM_PRD_OTPT_HIT_R_QTY_LMEV = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "DIM_MANUFACTURING_ORDER"
DIM_MANUFACTURING_ORDER = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "DIM_STAGE"
DIM_STAGE = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "DIM_PROCESS"
DIM_PROCESS = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "DIM_LINE"
DIM_LINE = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "DIM_SHIFT"
DIM_SHIFT = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "FCT_FPYR_IN_SINGLE_STATION"
FCT_FPYR_IN_SINGLE_STATION = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "FCT_FIRST_PASS_YIELD_RATE"
FCT_FIRST_PASS_YIELD_RATE = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "FCT_PRD_OTPT_HIT_R_QTY_LMEV"
FCT_PRD_OTPT_HIT_R_QTY_LMEV = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "FCT_ACM_SHIPMENT_AMT_HIT_RATE"
FCT_ACM_SHIPMENT_AMT_HIT_RATE = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


my_taskid = "FCT_MFG_EST_DLV_AMT_HIT_RATE"
FCT_MFG_EST_DLV_AMT_HIT_RATE = OracleOperator(
    task_id=my_taskid,
    postgres_conn_id='postgres_dwh',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(1),
    pool='postgres_dwh')


