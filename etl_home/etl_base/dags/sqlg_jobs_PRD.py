
# -*- coding: utf-8 -*-
# Author        : Jesse Wei
# LastUpdate    : 2020/10/04
# Impact        : Jobs generated by SQLG
# Message       : Humanity towards others, we live by sharing. Fear can hold you prisoner, only hope can set you free.

# from __future__ import print_function
import logging
import airflow
from datetime import datetime, timedelta
from airflow.operators.sensors import ExternalTaskSensor
from airflow.operators.python_operator import PythonOperator
from airflow.operators.oracle_operator import OracleOperator

from airflow import models
from airflow.models import Variable

# from acme.operators.dwh_operators import PostgresOperatorWithTemplatedParams


# DB_NAME = 'DWH'
    
my_taskid = "FND_COLUMNS"
with open('/usr/local/airflow/sql/'+ my_taskid + '/' + my_taskid + '.sql',) as sql_file:
    sql_list = list(filter(None, sql_file.read().split(';')))
    
# print('DEBUG:: ', sql_list) 
sql_list = map(str.strip, sql_list)
sql_list = list(filter(None, sql_list))

FND_COLUMNS = OracleOperator(
    task_id=my_taskid,
#    postgres_conn_id='oracle_default',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
#    sql=my_taskid + '/' + my_taskid + '.sql',
    sql=sql_list,
#    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(0),
#    pool='default_pool'
	)


my_taskid = "Z_CDOCUMENT_CHECKING_RULE"
Z_CDOCUMENT_CHECKING_RULE = OracleOperator(
    task_id=my_taskid,
#    postgres_conn_id='oracle_default',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
#    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(0),
#    pool='default_pool'
	)


my_taskid = "BTMS_EXPENSEPROJECT"
with open('/usr/local/airflow/sql/'+ my_taskid + '/' + my_taskid + '.sql',) as sql_file:
    sql_list = list(filter(None, sql_file.read().split(';')))
    
# print('DEBUG:: ', sql_list) 
sql_list = map(str.strip, sql_list)
sql_list = list(filter(None, sql_list))

BTMS_EXPENSEPROJECT = OracleOperator(
    task_id=my_taskid,
#    postgres_conn_id='oracle_default',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=sql_list,
#    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(0),
#    pool='default_pool'
	)


my_taskid = "SDM_EMPLOYEE_H"
SDM_EMPLOYEE_H = OracleOperator(
    task_id=my_taskid,
#    postgres_conn_id='oracle_default',
#    sql=DB_NAME + '/' + my_taskid + '/' + my_taskid + '.sql',
    sql=my_taskid + '/' + my_taskid + '.sql',
#    parameters={"window_start_date": "{{ ds }}", "window_end_date": "{{ tomorrow_ds }}"},
#    start_date=airflow.utils.dates.days_ago(0),
#    pool='default_pool'
	)


