
# -*- coding: utf-8 -*-
# Author        : Jesse Wei
# LastUpdate    : 2020/10/04
# Impact        : Jobs generated by SQLG
# Message       : Humanity towards others, we live by sharing. Fear can hold you prisoner, only hope can set you free.

# from __future__ import print_function
import logging
import airflow
from datetime import datetime, timedelta
from airflow.operators.sensors import ExternalTaskSensor
from airflow.operators.python_operator import PythonOperator
from airflow.operators.bash_operator import BashOperator
from airflow.contrib.sensors.file_sensor import FileSensor


from airflow import models
from airflow.models import Variable


from acme.operators.sqlg_oracle import OracleOperatorWithTemplatedParams
from airflow.operators.oracle_operator import OracleOperator
# DB_NAME = 'DWH'
# JOB_TYPE=ODS-MAIN

my_taskid = "FND_COLUMNS"
FND_COLUMNS = OracleOperatorWithTemplatedParams(
    task_id=my_taskid,
    parameters=({":END_DT_CHAR":"{{ ds_nodash }}"}),
    sql= "Begin SQLEXT." + my_taskid + "_SP("+  
        ":END_DT_CHAR"+
        "); End;"
    )
# JOB_TYPE=ODS-MAIN

my_taskid = "Z_CDOCUMENT_CHECKING_RULE"
Z_CDOCUMENT_CHECKING_RULE = OracleOperatorWithTemplatedParams(
    task_id=my_taskid,
    parameters=({":END_DT_CHAR":"{{ ds_nodash }}"}),
    sql= "Begin SQLEXT." + my_taskid + "_SP("+  
        ":END_DT_CHAR"+
        "); End;"
    )
# JOB_TYPE=ODS-MAIN

my_taskid = "BTMS_EXPENSEPROJECT"
BTMS_EXPENSEPROJECT = OracleOperatorWithTemplatedParams(
    task_id=my_taskid,
    parameters=({":END_DT_CHAR":"{{ ds_nodash }}"}),
    sql= "Begin SQLEXT." + my_taskid + "_SP("+  
        ":END_DT_CHAR"+
        "); End;"
    )
# JOB_TYPE=WATCH

my_taskid = "ODS_UP_consign_vendor_product_map_WH"
ODS_UP_consign_vendor_product_map_WH = FileSensor(
    task_id=my_taskid,
    filepath= "{{ var.value.DIR_SOURCE }}UPD/UP_consign_vendor_product_map_{{var.value.EDC}}.D"
    )
# JOB_TYPE=EXE

my_taskid = "ODS_UP_consign_vendor_product_map_CPD"
ODS_UP_consign_vendor_product_map_CPD = BashOperator(
    task_id=my_taskid,
    bash_command="/usr/bin/cp {{var.value.DIR_SOURCE}}UPD/PRD/UP_consign_vendor_product_map_{{var.value.EDC}}Y  {{var.value.DIR_TEMP}}/UPD/UP_consign_vendor_product_map.D"
    )
# JOB_TYPE=SQL

my_taskid = "UP_consign_vendor_product_map"
UP_consign_vendor_product_map = OracleOperatorWithTemplatedParams(
    task_id=my_taskid,
    parameters=({":END_DT_CHAR":"{{ ds_nodash }}"}),
    sql= "Begin SQLEXT." + my_taskid + "_SP("+  
        "); End;"
    )
# JOB_TYPE=ODS-IMP

my_taskid = "ODS_UP_consign_vendor_product_map_LD"
ODS_UP_consign_vendor_product_map_LD = BashOperator(
    task_id=my_taskid,
    bash_command="./ods_imp1.sh {{var.value.ETLUSER}}  {{var.value.ETLPWD}} {{var.value.DW_HOST}} {{var.value.EDC}}"
    )
# JOB_TYPE=SQL

my_taskid = "UP_consign_vendor_product_map_ODS"
UP_consign_vendor_product_map_ODS = OracleOperatorWithTemplatedParams(
    task_id=my_taskid,
    parameters=({":END_DT_CHAR":"{{ ds_nodash }}"}),
    sql= "Begin SQLEXT." + my_taskid + "_SP("+  
        "); End;"
    )
# JOB_TYPE=SQL

my_taskid = "UP_consign_vendor_product_map_H"
UP_consign_vendor_product_map_H = OracleOperatorWithTemplatedParams(
    task_id=my_taskid,
    parameters=({":END_DT_CHAR":"{{ ds_nodash }}"}),
    sql= "Begin SQLEXT." + my_taskid + "_SP("+  
        "); End;"
    )
# JOB_TYPE=WATCH

my_taskid = "ODS_UP_Expense_Budget_product_map_WH"
ODS_UP_Expense_Budget_product_map_WH = FileSensor(
    task_id=my_taskid,
    filepath= "{{ var.value.DIR_SOURCE }}UPD/UP_Expense_Budget_product_map_{{var.value.EDC}}.D"
    )
# JOB_TYPE=EXE

my_taskid = "ODS_UP_Expense_Budget_product_map_CPD"
ODS_UP_Expense_Budget_product_map_CPD = BashOperator(
    task_id=my_taskid,
    bash_command="/usr/bin/cp {{var.value.DIR_SOURCE}}UPD/PRD/UP_Expense_Budget_product_map_{{var.value.EDC}}Y  {{var.value.DIR_TEMP}}/UPD/UP_Expense_Budget_product_map.D"
    )
# JOB_TYPE=SQL

my_taskid = "UP_Expense_Budget_product_map"
UP_Expense_Budget_product_map = OracleOperatorWithTemplatedParams(
    task_id=my_taskid,
    parameters=({":END_DT_CHAR":"{{ ds_nodash }}"}),
    sql= "Begin SQLEXT." + my_taskid + "_SP("+  
        "); End;"
    )
# JOB_TYPE=ODS-IMP

my_taskid = "ODS_UP_Expense_Budget_product_map_LD"
ODS_UP_Expense_Budget_product_map_LD = BashOperator(
    task_id=my_taskid,
    bash_command="./ods_imp1.sh {{var.value.ETLUSER}}  {{var.value.ETLPWD}} {{var.value.DW_HOST}} {{var.value.EDC}}"
    )
# JOB_TYPE=SQL

my_taskid = "UP_Expense_Budget_product_map_ODS"
UP_Expense_Budget_product_map_ODS = OracleOperatorWithTemplatedParams(
    task_id=my_taskid,
    parameters=({":END_DT_CHAR":"{{ ds_nodash }}"}),
    sql= "Begin SQLEXT." + my_taskid + "_SP("+  
        "); End;"
    )
# JOB_TYPE=SQL

my_taskid = "UP_Expense_Budget_product_map_H"
UP_Expense_Budget_product_map_H = OracleOperatorWithTemplatedParams(
    task_id=my_taskid,
    parameters=({":END_DT_CHAR":"{{ ds_nodash }}"}),
    sql= "Begin SQLEXT." + my_taskid + "_SP("+  
        "); End;"
    )
